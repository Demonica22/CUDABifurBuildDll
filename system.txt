//CD

float h1 = h*0.5;
float h2 = h*0.5;

X[0] = X[0] + h1 * (a[3]*X[1] + X[0]*X[2]);
X[1] = X[1] + h1 * (-a[2] * X[0] + X[1]*X[2] + X[3] * X[3]);
X[2] = X[2] + h1 * (1 - X[0]*X[0] - X[1]*X[1]);
X[3] = X[3] + h1 * (-a[1]*X[1]);

X[3] = X[3] + h2 * (-a[1]*X[1]);
X[2] = X[2] + h2 * (1 - X[0]*X[0] - X[1]*X[1]);
X[1] = (X[1] + h2 * (X[3] * X[3] - a[2] * X[0])) / (1 - h2*X[2]);
X[0] = (X[0] + h2 * a[3] * X[1]) / (1 - h2 * X[2]);
